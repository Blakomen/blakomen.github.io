"use strict";(self.webpackChunkhenry_chong=self.webpackChunkhenry_chong||[]).push([[570],{2450:function(e,t,n){n.r(t),n.d(t,{Head:function(){return u},default:function(){return g}});var r=n(1151),a=n(7294);function o(e){const t=Object.assign({p:"p",pre:"pre",code:"code",strong:"strong",a:"a",em:"em"},(0,r.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.p,null,"In an InfoPath form I've been working on, I've used the Validating event to attach some code to do some more complex validation (ie, something that I can't achieve through rules).\r\nIt's actually not too complicated, and follows the following general syntax:"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-csharp"},'public void MyField_Validating(object sender, XmlValidatingEventArgs e)\r\n{\r\n    //clear any existing errors\r\n    try {\r\n        this.Errors.Delete("MyErrorName");\r\n    } catch (ArgumentException ex) { /* Error does not exist / has not been added. */ };\r\n\r\n    if(MyErrorTest())\r\n    {\r\n        this.Errors.Add(e.Site, "NoEmailsFound", "My error message.");\r\n    }\r\n}\n')),"\n",a.createElement(t.p,null,"However, it's important to note that ",a.createElement(t.strong,null,"during the Validating event the underlying form XML data is placed into a read-only state"),'.\r\nThis means that if you try and update a "notification" or "errormessage" field as part of a Validating event handler like I was, you will encounter an "InvalidOperationException: Operation is not valid due to the current state of the object". The ',a.createElement(t.a,{href:"http://64.4.11.251/en-us/library/microsoft.office.infopath.xmlevent.validating.aspx"},"MSDN reference on the XmlEvent.Validating event")," also mentions this somewhere on the page."),"\n",a.createElement(t.p,null,"Hope you've all had a fantastic Christmas, and are looking forward to an exciting new year!"),"\n",a.createElement(t.p,null,a.createElement(t.em,null,"[Edit: I've been having trouble getting the red border to appear when using e.ReportError / this.Errors.Add() for a People Picker control; the validation works as expected as submission is disabled and Ctrl+Shift+I brings up the validation error message, but there is no visual indicator for the error, which is rather annoying. ",a.createElement(t.a,{href:"http://social.msdn.microsoft.com/Forums/en/sharepointinfopath/thread/6b8ab5e8-1e70-4bce-a9dc-69538afb6bab"},"This thread was the only thing I could find about this error"),", but isn't particularly helpful as it suggests using design-time rules which I would use instead of code-behind, if it were possible...]")))}var i=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,r.ah)(),e.components);return t?a.createElement(t,e,a.createElement(o,e)):o(e)},l=n(1883),s=n(8032),c=n(5312),m=n(9357),d=n(62);const h=e=>{let{data:t,children:n}=e;const r=(0,s.c)(t.mdx.frontmatter.hero_image);return a.createElement(c.Z,{pageTitle:t.mdx.frontmatter.title},a.createElement("p",null,a.createElement("time",{dateTime:t.mdx.frontmatter.isoDate},t.mdx.frontmatter.date)),a.createElement("figure",null,a.createElement(s.G,{image:r,alt:t.mdx.frontmatter.hero_image_alt}),a.createElement("figcaption",null,a.createElement("p",null,"ðŸ“·:"," ",a.createElement("a",{href:t.mdx.frontmatter.hero_image_credit_link,target:"_blank",rel:"noreferrer"},t.mdx.frontmatter.hero_image_credit_text)))),n,a.createElement("div",{className:d.L},a.createElement("button",null,a.createElement(l.Link,{to:"/blog"},"ðŸ”™ Back to all posts"))))},u=e=>{let{data:t}=e;return a.createElement(m.Z,{title:t.mdx.frontmatter.title,description:t.mdx.excerpt})};function g(e){return a.createElement(h,e,a.createElement(i,e))}},62:function(e,t,n){n.d(t,{L:function(){return r}});var r="mdx-frontmatter__slug-module--blogNavigation--7494c"}}]);
//# sourceMappingURL=component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-infopath-validation-gotcha-mdx-d298421b90d200225df4.js.map